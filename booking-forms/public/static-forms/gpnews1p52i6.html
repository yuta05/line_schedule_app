<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>test</title>
    <script src="https://static.line-scdn.net/liff/edge/2/sdk.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background-color: #f5f5f5;
            line-height: 1.6;
        }
        
        body {
            font-family: 'Helvetica Neue', Arial, sans-serif;
            background-color: #f0f0f0;
            margin: 0;
            padding: 0;
            line-height: 1.6;
        }
        
        .container {
            max-width: 400px;
            margin: 0 auto;
            background: white;
            min-height: 100vh;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        
        .header {
            background: #f73b3b;
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
        }
        
        .form-content {
            padding: 20px;
        }
        
        .section {
            margin-bottom: 25px;
            padding: 15px;
            background: #f9f9f9;
            border-radius: 8px;
            border-left: 4px solid #f73b3b;
        }
        
        .section h3 {
            margin: 0 0 15px 0;
            color: #333;
            font-size: 1.1em;
        }
        
        .form-group {
            margin-bottom: 15px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
            font-size: 14px;
        }
        
        .form-input, .form-select {
            width: 100%;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
            box-sizing: border-box;
        }
        
        .form-input:focus, .form-select:focus {
            outline: none;
            border-color: #f73b3b;
        }
        
        .menu-sections {
            margin: 20px 0;
        }
        
        .menu-section {
            display: none;
            margin: 15px 0;
        }
        
        .menu-section.active {
            display: block;
        }
        
        .menu-buttons {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }
        
        .menu-buttons button {
            flex: 1;
            min-width: 120px;
            padding: 12px;
            background: #f0f0f0;
            border: 2px solid #ddd;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .menu-buttons button:hover {
            background: #e0e0e0;
        }
        
        .menu-buttons button.active {
            background: #f73b3b;
            color: white;
            border-color: #f73b3b;
        }
        
        .treatment-button {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            background: #f8f8f8;
            border: 2px solid #ddd;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            font-size: 16px;
            transition: all 0.3s;
        }
        
        .treatment-button:hover {
            background: #f0f0f0;
            border-color: #f73b3b;
        }
        
        .treatment-button.active {
            background: #f73b3b;
            color: white;
            border-color: #f73b3b;
        }
        
        .treatment-details {
            display: none;
            margin: 15px 0;
            padding: 20px;
            background: #f9f9f9;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
        }
        
        .treatment-details.show {
            display: block;
        }
        
        .treatment-image {
            width: 100%;
            max-width: 300px;
            height: auto;
            border-radius: 8px;
            margin: 10px 0;
        }
        
        .treatment-info {
            margin: 15px 0;
        }
        
        .treatment-price {
            font-size: 1.2em;
            font-weight: bold;
            color: #f73b3b;
        }
        
        .treatment-time {
            color: #666;
            font-size: 0.9em;
        }
        
        .submit-btn {
            width: 100%;
            padding: 16px;
            background: #f73b3b;
            color: white;
            border: none;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            margin-top: 20px;
        }
        
        .submit-btn:hover {
            opacity: 0.9;
        }
        
        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .calendar-section {
            margin: 20px 0;
        }
        
        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e1e5e9;
            border: 1px solid #e1e5e9;
            border-radius: 8px;
            overflow: hidden;
        }
        
        .calendar-day {
            background: white;
            padding: 12px;
            text-align: center;
            cursor: pointer;
            min-height: 48px;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        .calendar-day:hover {
            background: #f8f9fa;
        }
        
        .calendar-day.available {
            background: #f73b3b10;
        }
        
        .calendar-day.selected {
            background: #f73b3b;
            color: white;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .error {
            background: #fee;
            color: #c33;
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
        }
        
        .success {
            background: #efe;
            color: #373;
            padding: 12px;
            border-radius: 6px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>test</h1>
            <p>ÈùôÁöÑ„Éá„Éó„É≠„Ç§Áâà</p>
        </div>
        
        <div class="form-content">
            <div id="loading" class="loading">
                <p>Loading...</p>
            </div>
            
            <div id="form-container" style="display: none;">
                <form id="booking-form">
                    <!-- „ÅäÂÆ¢ÊßòÊÉÖÂ†± -->
                    <div class="section">
                        <h3>üë§ „ÅäÂÆ¢ÊßòÊÉÖÂ†±</h3>
                        <div class="form-group">
                            <label class="form-label">„ÅäÂêçÂâç *</label>
                            <input type="text" name="name" class="form-input" required>
                        </div>
                        
                        <div class="form-group">
                            <label class="form-label">ÈõªË©±Áï™Âè∑ *</label>
                            <input type="tel" name="phone" class="form-input" required>
                        </div>
                        
                        <!-- ÊÄßÂà•ÈÅ∏ÊäûÔºàË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥ÂêàÔºâ -->
                        
                    </div>
                    
                    <!-- Êù•Â∫óÂõûÊï∞ÈÅ∏ÊäûÔºàË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥ÂêàÔºâ -->
                    
                    
                    <!-- „ÇØ„Éº„Éù„É≥ÈÅ∏ÊäûÔºàË®≠ÂÆö„Åï„Çå„Å¶„ÅÑ„ÇãÂ†¥ÂêàÔºâ -->
                    
                    
                    <!-- „É°„Éã„É•„ÉºÈÅ∏Êäû -->
                    <div class="section">
                        <h3>üíÑ „É°„Éã„É•„ÉºÈÅ∏Êäû</h3>
                        
                        <!-- „É°„Éã„É•„Éº„Ç´„ÉÜ„Ç¥„É™„Éº„Éú„Çø„É≥ -->
                        <div class="menu-buttons">
                            
                                <button type="button" onclick="showMenu('menu1')" class="active">
                                    Êñ∞„Åó„ÅÑ„Ç´„ÉÜ„Ç¥„É™„Éº
                                </button>
                            
                        </div>
                        
                        <!-- „É°„Éã„É•„ÉºË©≥Á¥∞„Çª„ÇØ„Ç∑„Éß„É≥ -->
                        <div class="menu-sections">
                            
                                <div id="menu1" class="menu-section active">
                                    
                                                <button type="button" class="treatment-button" 
                                                        onclick="selectTreatment(this, 'menu1_menu0')"
                                                        data-price="3000"
                                                        data-duration="30">
                                                    <div style="font-weight: bold;">„Ç´„ÉÉ„Éà</div>
                                                    <div class="treatment-price">¬•3,000</div>
                                                    <div class="treatment-time">30ÂàÜ</div>
                                                </button>
                                                
                                                <div id="treatment-details-menu1_menu0" class="treatment-details">
                                                    
                                                    <div class="treatment-info">
                                                        <h4>„Ç´„ÉÉ„Éà</h4>
                                                        
                                                        <div class="treatment-price">¬•3,000</div>
                                                        <div class="treatment-time">30ÂàÜ</div>
                                                    </div>
                                                </div>
                                            
                                </div>
                            
                        </div>
                    </div>
                    
                    <!-- „Ç´„É¨„É≥„ÉÄ„Éº -->
                    <div class="calendar-section">
                        <h2>Êó•Á®ã„ÇíÈÅ∏Êäû</h2>
                        <div id="calendar-container">
                            <div class="calendar-grid" id="calendar-grid">
                                <!-- „Ç´„É¨„É≥„ÉÄ„Éº„ÅØJavaScript„ÅßÁîüÊàê -->
                            </div>
                        </div>
                    </div>
                    
                    <!-- ÊôÇÈñìÈÅ∏Êäû -->
                    <div class="form-group">
                        <label class="form-label">ÊôÇÈñì *</label>
                        <select name="time" class="form-input" required>
                            <option value="">„Åæ„ÅöÊó•Á®ã„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                        </select>
                    </div>
                    
                    <button type="submit" class="submit-btn">‰∫àÁ¥Ñ„Åô„Çã</button>
                </form>
            </div>
        </div>
    </div>

    <script>
        // LIFFÂàùÊúüÂåñ„Å®„Éï„Ç©„Éº„É†Ê©üËÉΩ
        const FORM_CONFIG = {"basic_info":{"form_name":"test","store_name":"","liff_id":"2008098784-5ZQ1LRn3","theme_color":"#f73b3b"},"visit_options":[],"gender_selection":{"enabled":false,"required":false,"options":[{"value":"male","label":"Áî∑ÊÄß"},{"value":"female","label":"Â•≥ÊÄß"}]},"visit_count_selection":{"enabled":false,"required":false,"options":[{"value":"first","label":"ÂàùÂõû"},{"value":"repeat","label":"2ÂõûÁõÆ‰ª•Èôç"}]},"coupon_selection":{"enabled":false,"coupon_name":"","options":[{"value":"use","label":"Âà©Áî®„Åô„Çã"},{"value":"not_use","label":"Âà©Áî®„Åó„Å™„ÅÑ"}]},"menu_structure":{"structure_type":"category_based","categories":[{"id":"category_1758774353423","name":"Êñ∞„Åó„ÅÑ„Ç´„ÉÜ„Ç¥„É™„Éº","display_name":"Êñ∞„Åó„ÅÑ„Ç´„ÉÜ„Ç¥„É™„Éº","menus":[{"id":"menu_1758774400839","name":"„Ç´„ÉÉ„Éà","price":3000,"duration":30,"category_id":"category_1758774353423","options":[{"id":"option_1758774399281","name":"„Ç∑„É£„É≥„Éó„Éº","price":1000,"duration":10,"is_default":false}],"has_submenu":false}],"options":[],"selection_mode":"single","gender_condition":"all"}],"display_options":{"show_price":true,"show_duration":true,"show_description":true,"show_treatment_info":false}},"calendar_settings":{"business_hours":{"monday":{"open":"09:00","close":"18:00","closed":false},"tuesday":{"open":"09:00","close":"18:00","closed":false},"wednesday":{"open":"09:00","close":"18:00","closed":false},"thursday":{"open":"09:00","close":"18:00","closed":false},"friday":{"open":"09:00","close":"18:00","closed":false},"saturday":{"open":"09:00","close":"18:00","closed":false},"sunday":{"open":"09:00","close":"18:00","closed":true}},"advance_booking_days":30},"ui_settings":{"theme_color":"#3B82F6","button_style":"rounded","show_repeat_booking":false,"show_side_nav":true},"validation_rules":{"required_fields":["name","phone"],"phone_format":"japanese","name_max_length":50},"gas_endpoint":"https://script.google.com/macros/s/AKfycby3QfS2E892nXbS-fnfBVrJX8KyJWTSsisKpe9zVz5QGWzvTH7Zc3PlOay9j60aSQLp/exec"};
        const FORM_ID = "gpnews1p52i6";
        
        // LIFFÂàùÊúüÂåñ
        liff.init({
            liffId: "2008098784-5ZQ1LRn3"
        }).then(() => {
            console.log('LIFF initialized');
            document.getElementById('loading').style.display = 'none';
            document.getElementById('form-container').style.display = 'block';
            initializeForm();
        }).catch((err) => {
            console.error('LIFF initialization failed', err);
            document.getElementById('loading').innerHTML = '<p style="color: red;">LIFF„ÅÆÂàùÊúüÂåñ„Å´Â§±Êïó„Åó„Åæ„Åó„Åü</p>';
        });
        
        function initializeForm() {
            // „Ç´„É¨„É≥„ÉÄ„Éº„ÅÆÂàùÊúüÂåñ
            initializeCalendar();
            
            // „Éï„Ç©„Éº„É†ÈÄÅ‰ø°„ÅÆÂá¶ÁêÜ
            document.getElementById('booking-form').addEventListener('submit', handleSubmit);
        }
        
        // „É°„Éã„É•„ÉºË°®Á§∫Âàá„ÇäÊõø„Åà
        function showMenu(menuId) {
            // ÂÖ®„Å¶„ÅÆ„É°„Éã„É•„Éº„Çª„ÇØ„Ç∑„Éß„É≥„ÇíÈùûË°®Á§∫
            document.querySelectorAll('.menu-section').forEach(section => {
                section.classList.remove('active');
            });
            
            // ÂÖ®„Å¶„ÅÆ„É°„Éã„É•„Éº„Éú„Çø„É≥„ÅÆÈÅ∏ÊäûÁä∂ÊÖã„Çí„É™„Çª„ÉÉ„Éà
            document.querySelectorAll('.menu-buttons button').forEach(button => {
                button.classList.remove('active');
            });
            
            // ÊåáÂÆö„Åï„Çå„Åü„É°„Éã„É•„Éº„Çª„ÇØ„Ç∑„Éß„É≥„ÇíË°®Á§∫
            document.getElementById(menuId).classList.add('active');
            
            // ÂØæÂøú„Åô„Çã„Éú„Çø„É≥„ÇíÈÅ∏ÊäûÁä∂ÊÖã„Å´„Åô„Çã
            event.target.classList.add('active');
            
            // Ê≤ªÁôÇË©≥Á¥∞„ÇíÈùûË°®Á§∫
            document.querySelectorAll('.treatment-details').forEach(detail => {
                detail.classList.remove('show');
            });
        }
        
        // Ê≤ªÁôÇÈÅ∏Êäû
        let selectedTreatment = null;
        let selectedPrice = 0;
        
        function selectTreatment(button, treatmentId) {
            // Êó¢Â≠ò„ÅÆÈÅ∏Êäû„Çí„ÇØ„É™„Ç¢
            document.querySelectorAll('.treatment-button').forEach(btn => {
                btn.classList.remove('active');
            });
            
            // Êó¢Â≠ò„ÅÆË©≥Á¥∞Ë°®Á§∫„Çí„ÇØ„É™„Ç¢
            document.querySelectorAll('.treatment-details').forEach(detail => {
                detail.classList.remove('show');
            });
            
            // Êñ∞„Åó„ÅÑÈÅ∏Êäû„ÇíË®≠ÂÆö
            button.classList.add('active');
            selectedTreatment = button.textContent.trim();
            selectedPrice = parseInt(button.getAttribute('data-price')) || 0;
            
            // ÂØæÂøú„Åô„ÇãË©≥Á¥∞„ÇíË°®Á§∫
            const detailElement = document.getElementById('treatment-details-' + treatmentId);
            if (detailElement) {
                detailElement.classList.add('show');
                // „Éú„Çø„É≥„ÅÆÁõ¥Âæå„Å´Ë©≥Á¥∞„ÇíÁßªÂãï
                button.parentNode.insertBefore(detailElement, button.nextSibling);
            }
            
            // ÂêàË®àÈáëÈ°ç„ÇíÊõ¥Êñ∞
            updateTotalDisplay();
        }
        
        function initializeCalendar() {
            const calendar = document.getElementById('calendar-grid');
            const today = new Date();
            const currentMonth = today.getMonth();
            const currentYear = today.getFullYear();
            
            // Á∞°Âçò„Å™„Ç´„É¨„É≥„ÉÄ„ÉºË°®Á§∫ÔºàÂÆüÈöõ„ÅØ„Çà„ÇäË§áÈõë„Å™ÂÆüË£Ö„ÅåÂøÖË¶ÅÔºâ
            const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
            const firstDay = new Date(currentYear, currentMonth, 1).getDay();
            
            let calendarHTML = '';
            
            // ÊõúÊó•„Éò„ÉÉ„ÉÄ„Éº
            const dayNames = ['Êó•', 'Êúà', 'ÁÅ´', 'Ê∞¥', 'Êú®', 'Èáë', 'Âúü'];
            dayNames.forEach(day => {
                calendarHTML += `<div class="calendar-day" style="background: #f8f9fa; font-weight: bold;">${day}</div>`;
            });
            
            // ÂâçÊúà„ÅÆÁ©∫ÁôΩ
            for (let i = 0; i < firstDay; i++) {
                calendarHTML += '<div class="calendar-day"></div>';
            }
            
            // Êó•‰ªò
            for (let day = 1; day <= daysInMonth; day++) {
                const date = new Date(currentYear, currentMonth, day);
                const isToday = date.toDateString() === today.toDateString();
                const isFuture = date > today;
                
                calendarHTML += `<div class="calendar-day ${isFuture ? 'available' : ''}" data-date="${date.toISOString().split('T')[0]}" ${isFuture ? 'onclick="selectDate(this)"' : ''}>${day}</div>`;
            }
            
            calendar.innerHTML = calendarHTML;
        }
        
        function selectDate(element) {
            // Êó¢Â≠ò„ÅÆÈÅ∏Êäû„Çí„ÇØ„É™„Ç¢
            document.querySelectorAll('.calendar-day.selected').forEach(el => {
                el.classList.remove('selected');
            });
            
            // Êñ∞„Åó„ÅÑÊó•‰ªò„ÇíÈÅ∏Êäû
            element.classList.add('selected');
            
            // ÊôÇÈñìÈÅ∏Êäû„ÇíÊõ¥Êñ∞ÔºàÁ∞°Áï•ÂåñÔºâ
            const timeSelect = document.querySelector('select[name="time"]');
            timeSelect.innerHTML = `
                <option value="">ÊôÇÈñì„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ</option>
                <option value="09:00">9:00</option>
                <option value="10:00">10:00</option>
                <option value="11:00">11:00</option>
                <option value="13:00">13:00</option>
                <option value="14:00">14:00</option>
                <option value="15:00">15:00</option>
                <option value="16:00">16:00</option>
                <option value="17:00">17:00</option>
            `;
        }
        
        // Êù•Â∫óÂõûÊï∞ÈÅ∏Êäû
        function selectVisit(button) {
            document.querySelectorAll('.menu-buttons button').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
        }
        
        // „ÇØ„Éº„Éù„É≥ÈÅ∏Êäû
        function selectCoupon(button) {
            document.querySelectorAll('.menu-buttons button').forEach(btn => {
                btn.classList.remove('active');
            });
            button.classList.add('active');
        }
        
        // ÂêàË®àË°®Á§∫Êõ¥Êñ∞
        function updateTotalDisplay() {
            // ‰æ°Ê†ºË°®Á§∫„É≠„Ç∏„ÉÉ„ÇØÔºàÂøÖË¶Å„Å´Âøú„Åò„Å¶ÂÆüË£ÖÔºâ
        }
        
        function handleSubmit(event) {
            event.preventDefault();
            
            const formData = new FormData(event.target);
            const selectedDate = document.querySelector('.calendar-day.selected')?.dataset.date;
            
            if (!selectedTreatment) {
                alert('„É°„Éã„É•„Éº„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            if (!selectedDate) {
                alert('Êó•Á®ã„ÇíÈÅ∏Êäû„Åó„Å¶„Åè„Å†„Åï„ÅÑ');
                return;
            }
            
            const bookingData = {
                name: formData.get('name'),
                phone: formData.get('phone'),
                gender: formData.get('gender') || null,
                treatment: selectedTreatment,
                date: selectedDate,
                time: formData.get('time'),
                message: formData.get('message') || '',
                form_id: FORM_ID
            };
            
            // LIFFÁµåÁî±„ÅßLINE„Éà„Éº„ÇØ„Å´ÈÄÅ‰ø°
            if (typeof liff !== 'undefined') {
                const message = `„Äê‰∫àÁ¥Ñ„Éï„Ç©„Éº„É†„Äë
„ÅäÂêçÂâçÔºö${bookingData.name}
ÈõªË©±Áï™Âè∑Ôºö${bookingData.phone}
„É°„Éã„É•„ÉºÔºö${bookingData.treatment}
Â∏åÊúõÊó•ÊôÇÔºö${bookingData.date} ${bookingData.time}
„É°„ÉÉ„Çª„Éº„Ç∏Ôºö${bookingData.message}`;

                liff.sendMessages([{
                    type: 'text',
                    text: message
                }]).then(() => {
                    alert('‰∫àÁ¥ÑÁî≥„ÅóËæº„Åø„ÇíÈÄÅ‰ø°„Åó„Åæ„Åó„Åü');
                    liff.closeWindow();
                }).catch((err) => {
                    console.error('„É°„ÉÉ„Çª„Éº„Ç∏ÈÄÅ‰ø°„Ç®„É©„Éº:', err);
                    alert('ÈÄÅ‰ø°„Å´Â§±Êïó„Åó„Åæ„Åó„Åü');
                });
            } else {
                // ÈñãÁô∫Áí∞Â¢ÉÁî®
                console.log('Booking data:', bookingData);
                alert('‰∫àÁ¥Ñ„Éá„Éº„ÇøÔºàÈñãÁô∫ÁâàÔºâ:\n' + JSON.stringify(bookingData, null, 2));
            }
        }
    </script>
</body>
</html>