GPT：https://chatgpt.com/share/68a70a71-0dc4-800e-8a52-0b2332e5e026

予約前日リマインド：実装手順（GAS + Googleカレンダー + LINE）
0. 仕様（サマリ）

対象：翌日のGoogleカレンダーイベント

条件：イベントの**場所（Location）欄に「識別ID（＝LINEのユーザーID）」**が入っているものだけ

動作：該当イベントごとに、その識別IDのLINE友だちへリマインド（Flex）をプッシュ送信

送信内容：日付・時間、メニュー（説明欄から抽出）、挨拶


【1. 事前準備】

LINE Developers

Messaging APIチャネル作成

**チャネルアクセストークン（長期）**を控える

Googleカレンダー

リマインド対象のカレンダーを決め、カレンダーIDを控える
（Googleカレンダー → 設定 → 対象カレンダー →「カレンダーの統合」→ カレンダーID）


【イベントの入力ルール】

イベントの**場所（Location）欄：識別ID（＝LINEのユーザーID）**を入れる

イベントの説明（Description）欄：
下記のように囲うと自動抽出されます

≪希望日時≫ 2025年08月04日 13:00
≪LINEの名前≫ 中江つばさ
≪お名前≫ ワクワクテスト予約
≪電話番号≫ 01001010101
≪メニュー≫ 
・モイスティーヌPro（シンプル）
≪ご来店回数≫ リピーター様
≪メッセージ≫ 


【2. GAS（Apps Script）に貼り付けるコード】

Apps Script エディタで新規プロジェクトを作成し、"GAS_リマインドメッセージ.txt"を丸ごとコピペ

"GAS_リマインドメッセージ.txt"の2行目にGoogleカレンダーのカレンダーIDを置き換える。
24行目に公式LINEのLINE_CHANNEL_ACCESS_TOKENを置き換える。


【3. トリガー設定（自動実行）】

Apps Scriptエディタ → 左側「時計」アイコン（トリガー） → トリガーを追加

実行する関数：sendReminderMessages

イベントのソース：時間主導型

時間ベースのトリガー：日付ベースのタイマー

実行時刻：毎日 19:00 など（お店に合わせて設定）

例）「前日の19:00に翌日の予約をまとめて通知」など

【4. よくあるQA】

Q. イベントが取得されない
A. カレンダーIDの間違い／トリガーのタイムゾーン違い／翌日にイベントが無い、などを確認

Q. 誰にも届かない
A. イベントの場所（Location）にLINEユーザーIDが入っているか確認（空欄だとスキップ）

Q. メニューが「未設定」になる
A. 説明欄の記述が【1. 事前準備】の【イベントの入力ルール】に記載されているテンプレートの形式になっているか確認
