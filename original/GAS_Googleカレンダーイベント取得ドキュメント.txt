GPT:https://chatgpt.com/share/68a70ab2-5ea8-800e-8138-265e64935fdb

【目的】
・Googleカレンダーの予定（埋まっている時間）をGASでJSONとして返す
・予約フォーム側は、そのJSONを読んで空き＝「○」、埋まり＝「×」に切り替える

【前提】
・Googleアカウント（対象カレンダーの編集権限あり）
・対象となるGoogleカレンダーの「カレンダーID」
・Apps Script（GAS）にアクセスできること
・予約フォーム側で「カレンダーURL（＝GASのWebアプリURL）」を設定できること


【手順1：カレンダーIDの確認】

Googleカレンダーを開く → 左サイドバーの対象カレンダーの「︙」→［設定と共有］

下部「カレンダーの統合」→「カレンダーID」をコピー（例：xxxx@group.calendar.google.com）


【手順2：GASプロジェクトの作成】

https://script.google.com/
 →［新しいスクリプトを作成］

エディタに用意済みのコードを貼り付け
　・calendarId = 'カレンダーID' の箇所を、手順1で取得したIDに置き換える（シングルクォート内）
　・コードはアップロード済みテキストの内容をそのまま使用（JSONで予定一覧を返すAPI）


【手順3：スコープと権限（初回のみ）】
・このコードは CalendarApp を使用するため、初回実行またはデプロイ時に権限承認ダイアログが出ます
・指示に従って承認してください（自身のGoogleアカウントを選択）

【手順4：Webアプリとしてデプロイ】

エディタ右上［デプロイ］→［新しいデプロイ］

種類：［ウェブアプリ］

説明：任意（例：予約空き状況API）

実行するユーザー：自分（または必要に応じて）

アクセスできるユーザー：全員（匿名含む）

［デプロイ］→ 表示された「WebアプリのURL」をコピー（これがカレンダーURL）


【手順5：予約フォーム側の設定】
・フォーム管理画面の「カレンダーURL」欄に、手順4でコピーしたWebアプリURLをそのまま貼り付け(予約フォーム.htmlの1562行)

【手順6：よくあるつまずき】
・「権限不足」→ デプロイ時の「アクセスできるユーザー」を再確認。匿名アクセスが必要なら「全員」に設定
・「何も返らない」→ startTime / endTime のISO8601表記（…Zで終わるUTC）を確認
・「日本時間と合わない」→ 本GASはAsia/Tokyoにフォールバック済み（内部でJST換算）。それでもズレるときは、引数の時間生成側（フォームJS）を点検
・「カレンダーIDが違う」→ 個人用とリソース用など複数ある場合は正しいIDを再確認

【備考（コード仕様のポイント）】
・startTime / endTime を必須パラメータとして受け取り、該当期間のイベントをJSONで返却
・タイムゾーンはスクリプト設定 or Asia/Tokyo へフォールバック
・エラー時はJSONで { "error": "…" } を返却
（詳細は提供コード参照）
