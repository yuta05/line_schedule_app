function sendReminderMessages() {
  const calendarId = "ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ID"; // Googleã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ID
  const now = new Date();

  // ç¿Œæ—¥ã®8æ™‚ï½21æ™‚ã®æ™‚é–“ç¯„å›²ã‚’è¨­å®š
  const tomorrow = new Date(now.getFullYear(), now.getMonth(), now.getDate() + 1);
  const startTime = new Date(tomorrow.setHours(8, 0, 0)); // ç¿Œæ—¥8æ™‚
  const endTime = new Date(tomorrow.setHours(21, 0, 0)); // ç¿Œæ—¥21æ™‚

  // ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‹ã‚‰ã‚¤ãƒ™ãƒ³ãƒˆã‚’å–å¾—ï¼ˆç¿Œæ—¥ã®8æ™‚ï½21æ™‚ã®ç¯„å›²ï¼‰
  const calendar = CalendarApp.getCalendarById(calendarId);
  if (!calendar) {
    console.error("æŒ‡å®šã—ãŸã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼IDãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã€‚");
    return;
  }

  const events = calendar.getEvents(startTime, endTime);
  if (events.length === 0) {
    console.log("å¯¾è±¡ã®ã‚¤ãƒ™ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã€‚");
    return;
  }

  // LINE Messaging APIç”¨è¨­å®š
  const LINE_CHANNEL_ACCESS_TOKEN = "0YU5gWvZd3IlR/XO2S8L2U6LL/vPwQr6zV2pGoVFaYFOnhZcDx7WoxnAcR7G58j2TBj+FTYOTlI7bmDiQ39/8jhs4xDdnQSHqqmI9eG0RWE4Q7i/g8G/JdRFEPoxUYMXUq3nxrpRYdKxAyWPH+93lgdB04t89/1O/w1cDnyilFU=";
  const LINE_API_URL = "https://api.line.me/v2/bot/message/push";

  events.forEach(event => {
    const userId = event.getLocation(); // ãƒ¦ãƒ¼ã‚¶ãƒ¼IDã‚’å ´æ‰€æ¬„ã‹ã‚‰å–å¾—
    if (userId) {
      const description = event.getDescription() || '';

      const menuMatch = description.match(/â‰ªãƒ¡ãƒ‹ãƒ¥ãƒ¼â‰«\s*([\s\S]*?)â‰ª/);
      const menuText = menuMatch ? menuMatch[1].trim() : 'æœªè¨­å®š';

      const dateTime = event.getStartTime();
      const weekdays = ["æ—¥", "æœˆ", "ç«", "æ°´", "æœ¨", "é‡‘", "åœŸ"];
      const dateText = Utilities.formatDate(dateTime, Session.getScriptTimeZone(), "yyyyå¹´MMæœˆddæ—¥") + "ï¼ˆ" + weekdays[dateTime.getDay()] + "ï¼‰ " + Utilities.formatDate(dateTime, Session.getScriptTimeZone(), "HHæ™‚mmåˆ†");

      // Flexãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ä½œæˆ
      const flexMessage = {
        type: 'flex',
        altText: 'ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸',
        contents: {
          type: 'bubble',
          size: 'mega',
          header: {
            type: 'box',
            layout: 'vertical',
            contents: [
              {
                type: 'text',
                text: 'åº—èˆ—',
                color: '#ffffff66',
                size: 'sm'
              },
              {
                type: 'text',
                text: 'ã€äºˆç´„å‰æ—¥ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã€‘',
                color: '#ffffff',
                size: 'xl',
                weight: 'bold'
              }
            ],
            paddingAll: '20px',
            backgroundColor: '#877059'
          },
          body: {
            type: 'box',
            layout: 'vertical',
            contents: [
              {
                type: 'text',
                text: 'æ˜æ—¥ã®äºˆç´„ã‚’ãŠçŸ¥ã‚‰ã›ã—ã¾ã™',
                weight: 'bold',
                size: 'lg',
                color: '#333333',
                wrap: true,
                align: 'center',
                margin: 'md'
              },
              {
                type: 'separator',
                margin: 'lg',
                color: '#CCCCCC'
              },
              {
                type: 'box',
                layout: 'vertical',
                contents: [
                  {
                    type: 'text',
                    text: 'ğŸ“… æ—¥æ™‚',
                    color: '#666666',
                    size: 'sm',
                    weight: 'bold',
                    margin: 'md'
                  },
                  {
                    type: 'text',
                    text: dateText,
                    wrap: true,
                    size: 'sm',
                    color: '#333333',
                    margin: 'xs'
                  },
                  {
                    type: 'text',
                    text: 'ğŸ“ ãƒ¡ãƒ‹ãƒ¥ãƒ¼',
                    color: '#666666',
                    size: 'sm',
                    weight: 'bold',
                    margin: 'lg'
                  },
                  {
                    type: 'text',
                    text: menuText,
                    wrap: true,
                    size: 'sm',
                    color: '#333333',
                    margin: 'xs'
                  }
                ],
                margin: 'lg'
              },
              {
                type: 'separator',
                margin: 'xxl',
                color: '#CCCCCC'
              },
              {
                type: 'text',
                text: 'å¿ƒã‚ˆã‚ŠãŠå¾…ã¡ã—ã¦ãŠã‚Šã¾ã™',
                wrap: true,
                margin: 'xl',
                size: 'sm',
                align: 'center',
                color: '#474646'
              }
            ]
          }

        }
      };

      // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸é€ä¿¡
      const payload = {
        to: userId,
        messages: [flexMessage]
      };

      const options = {
        method: "post",
        contentType: "application/json",
        headers: {
          Authorization: `Bearer ${LINE_CHANNEL_ACCESS_TOKEN}`
        },
        payload: JSON.stringify(payload)
      };

      try {
        const response = UrlFetchApp.fetch(LINE_API_URL, options);
        if (response.getResponseCode() === 200) {
          console.log(`é€ä¿¡æˆåŠŸ: ${userId}ã«ãƒªãƒã‚¤ãƒ³ãƒ‰ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã‚’é€ä¿¡ã—ã¾ã—ãŸ`);
        } else {
          console.log(`é€ä¿¡å¤±æ•—: ${response.getContentText()}`);
        }
      } catch (e) {
        console.error(`ã‚¨ãƒ©ãƒ¼ç™ºç”Ÿ: ${e.message}`);
      }
    }
  });
}
